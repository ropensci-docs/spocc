<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Search on a single species name, or many. And search across a single
or many data sources."><title>Search for species occurrence data across many data sources. — occ • spocc</title><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Search for species occurrence data across many data sources. — occ"><meta property="og:description" content="Search on a single species name, or many. And search across a single
or many data sources."><meta property="og:image" content="https://docs.ropensci.org/spocc/logo.png"><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css"><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript><!-- End Matomo Code --></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">spocc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.2.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="nav-link" href="../articles/spocc.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/fixnames.html">cleaning names</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/spocc/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Search for species occurrence data across many data sources.</h1>
      <small class="dont-index">Source: <a href="https://github.com/ropensci/spocc/blob/HEAD/R/occ.r" class="external-link"><code>R/occ.r</code></a></small>
      <div class="d-none name"><code>occ.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Search on a single species name, or many. And search across a single
or many data sources.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">occ</span><span class="op">(</span></span>
<span>  query <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  from <span class="op">=</span> <span class="st">"gbif"</span>,</span>
<span>  limit <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  start <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  page <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  geometry <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  has_coords <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ids <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  date <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  callopts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  gbifopts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  inatopts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  ebirdopts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  vertnetopts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  idigbioopts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  obisopts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  alaopts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  throw_warnings <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>query</dt>
<dd><p>(character) One to many scientific names. See Details for what parameter
in each data source we query. Note: ebird now expects species codes instead of
scientific names - we pass you name through <code><a href="https://docs.ropensci.org/rebird/reference/species_code.html" class="external-link">rebird::species_code()</a></code> internally</p></dd>


<dt>from</dt>
<dd><p>(character) Data source to get data from, any combination of gbif,
inat, ebird, vertnet, idigbio, obis, or ala. See <code>vignette(topic = 'spocc introduction')</code>
for more details about these sources.</p></dd>


<dt>limit</dt>
<dd><p>(numeric) Number of records to return. This is passed across all sources.
To specify different limits for each source, use the options for each source (gbifopts,
inatopts, and ebirdopts). See Details for more.
Default: 500 for each source. BEWARE: if you have a lot of species to query for (e.g.,
n = 10), that's 10 * 500 = 5000, which can take a while to collect. So, when you first query,
set the limit to something smallish so that you can get a result quickly, then do more as
needed.</p></dd>


<dt>start, page</dt>
<dd><p>(integer) Record to start at or page to start at. See <code>Paging</code> in
Details for how these parameters are used internally. Optional</p></dd>


<dt>geometry</dt>
<dd><p>(character or nmeric) One of a Well Known Text (WKT) object, a vector of
length 4 specifying a bounding box, or an sf object (sfg, sfc, or sf). This parameter
searches for occurrences inside a
polygon - converted to a polygon from whatever user input is given. A WKT shape written as
<code>POLYGON((30.1 10.1, 20 40, 40 40, 30.1 10.1))</code> would be queried as is,
i.e. http://bit.ly/HwUSif. See Details for more examples of WKT objects. The format of a
bounding box is <code>min-longitude, min-latitude, max-longitude, max-latitude</code>. Geometry
is not possible with vertnet right now, but should be soon. See Details for more info
on geometry inputs.</p></dd>


<dt>has_coords</dt>
<dd><p>(logical) Only return occurrences that have lat/long data. This works
for gbif, rinat, idigbio, and vertnet, but is ignored for ebird.
You can easily though remove records without lat/long data.</p></dd>


<dt>ids</dt>
<dd><p>Taxonomic identifiers. This can be a list of length 1 to many. See examples for
usage. Currently, identifiers for only 'gbif' for parameter 'from' supported. If
this parameter is used, query parameter can not be used - if it is, a warning is thrown.</p></dd>


<dt>date</dt>
<dd><p>(character/Date) A length 2 vector containing two dates of the form
YYY-MM-DD. These can be character of Date class. These are used to do a date range search.
Of course there are other types of date searches one may want to do but date range
seems like the most common date search use case.</p></dd>


<dt>callopts</dt>
<dd><p>Options passed on to <a href="https://docs.ropensci.org/crul/reference/HttpClient.html" class="external-link">crul::HttpClient</a>, e.g.,
for debugging curl calls, setting timeouts, etc.</p></dd>


<dt>gbifopts</dt>
<dd><p>(list) List of named options to pass on to
<code><a href="https://docs.ropensci.org/rgbif/reference/occ_search.html" class="external-link">rgbif::occ_search()</a></code>. See also <code><a href="occ_options.html">occ_options()</a></code></p></dd>


<dt>inatopts</dt>
<dd><p>(list) List of named options to pass on to internal function
<code>get_inat_obs</code></p></dd>


<dt>ebirdopts</dt>
<dd><p>(list) List of named options to pass on to
<code><a href="https://docs.ropensci.org/rebird/reference/ebirdregion.html" class="external-link">rebird::ebirdregion()</a></code> or <code><a href="https://docs.ropensci.org/rebird/reference/ebirdgeo.html" class="external-link">rebird::ebirdgeo()</a></code>. See also <code><a href="occ_options.html">occ_options()</a></code></p></dd>


<dt>vertnetopts</dt>
<dd><p>(list) List of named options to pass on to
<code><a href="https://docs.ropensci.org/rvertnet/reference/searchbyterm.html" class="external-link">rvertnet::searchbyterm()</a></code>. See also <code><a href="occ_options.html">occ_options()</a></code>.</p></dd>


<dt>idigbioopts</dt>
<dd><p>(list) List of named options to pass on to
<code><a href="https://rdrr.io/pkg/ridigbio/man/idig_search_records.html" class="external-link">ridigbio::idig_search_records()</a></code>. See also <code><a href="occ_options.html">occ_options()</a></code>.</p></dd>


<dt>obisopts</dt>
<dd><p>(list) List of named options to pass on to internal function.
See  https://api.obis.org/#/Occurrence/get_occurrence and <a href="obis_search.html">obis_search</a> for
what parameters can be used.</p></dd>


<dt>alaopts</dt>
<dd><p>(list) List of named options to pass on to internal function.</p></dd>


<dt>throw_warnings</dt>
<dd><p>(logical) <code>occ()</code> collects errors returned from each
data provider when they occur, and are accessible in the <code>$meta$errors</code> slot
for each data provider. If you set <code>throw_warnings=TRUE</code>, we give these
request errors as warnings with <code><a href="https://rdrr.io/r/base/warning.html" class="external-link">warning()</a></code>. if <code>FALSE</code>, we don't give warnings,
but you can still access them in the output.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>an object of class <code>occdat</code>, with a print method to give a brief
summary. The print method only shows results for those that have some
results (those with no results are not shown). The <code>occdat</code> class is just
a thin wrapper around a named list, where the top level names are the
data sources:</p><ul><li><p>gbif</p></li>
<li><p>inat</p></li>
<li><p>ebird</p></li>
<li><p>vertnet</p></li>
<li><p>idigbio</p></li>
<li><p>obis</p></li>
<li><p>ala</p></li>
</ul><p>Note that you only get data back for sources that were specified in the <code>from</code></p>


<p>parameter. All others are present, but empty.</p>


<p>Then within each data source is an object of class <code>occdatind</code> holding another
named list that contains:</p><ul><li><p>meta: metadata</p><ul><li><p>source: the data source name (e.g., "gbif")</p></li>
<li><p>time: time the request was sent</p></li>
<li><p>found: number of records found (number found across all queries)</p></li>
<li><p>returned: number of records returned (number of rows in all data.frame's
in the <code>data</code> slot)</p></li>
<li><p>type: query type, only "sci" for scientific</p></li>
<li><p>opts: a named list with the options you sent to the data source</p></li>
<li><p>errors: a character vector of errors returned, if any occurred</p></li>
</ul></li>
<li><p>data: named list of data.frame's, named by the queries sent</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>occ</code> function is an opinionated wrapper
around the rgbif, rinat, rebird, rvertnet and
ridigbio packages (as well as internal custom wrappers around some data
sources) to allow data access from a single access point. We take
care of making sure you get useful objects out at the cost of
flexibility/options - although you can still set options for each of the
packages via the gbifopts, inatopts, etc. parameters.</p>
    </div>
    <div class="section level2">
    <h2 id="inputs">Inputs<a class="anchor" aria-label="anchor" href="#inputs"></a></h2>
    

<p>All inputs to <code>occ</code> are one of:</p><ul><li><p>scientific name</p></li>
<li><p>taxonomic id</p></li>
<li><p>geometry as bounds, WKT, os Spatial classes</p></li>
</ul><p>To search by common name, first use <code><a href="occ_names.html">occ_names()</a></code> to find scientic names or
taxonomic IDs, then feed those to this function. Or use the <code>taxize</code> package
to get names and/or IDs to use here.</p>
    </div>
    <div class="section level2">
    <h2 id="using-the-query-parameter">Using the query parameter<a class="anchor" aria-label="anchor" href="#using-the-query-parameter"></a></h2>
    

<p>When you use the <code>query</code> parameter, we pass your search terms on to parameters
within functions that query data sources you specify. Those parameters are:</p><ul><li><p>rgbif - <code>scientificName</code> in the <code><a href="https://docs.ropensci.org/rgbif/reference/occ_search.html" class="external-link">rgbif::occ_search()</a></code> function - API
parameter: same as the <code>occ</code> parameter</p></li>
<li><p>rebird - <code>species</code> in the <code><a href="https://docs.ropensci.org/rebird/reference/ebirdregion.html" class="external-link">rebird::ebirdregion()</a></code> or
<code><a href="https://docs.ropensci.org/rebird/reference/ebirdgeo.html" class="external-link">rebird::ebirdgeo()</a></code> functions, depending on whether you set
<code>method="ebirdregion"</code> or <code>method="ebirdgeo"</code> - API parameters: <code>sci</code> for both
<code><a href="https://docs.ropensci.org/rebird/reference/ebirdregion.html" class="external-link">rebird::ebirdregion()</a></code> and <code><a href="https://docs.ropensci.org/rebird/reference/ebirdgeo.html" class="external-link">rebird::ebirdgeo()</a></code></p></li>
<li><p>rvertnet - <code>taxon</code> in the <code><a href="https://docs.ropensci.org/rvertnet/reference/vertsearch.html" class="external-link">rvertnet::vertsearch()</a></code> function - API
parameter: <code>q</code></p></li>
<li><p>ridigbio - <code>scientificname</code> in the <code><a href="https://rdrr.io/pkg/ridigbio/man/idig_search_records.html" class="external-link">ridigbio::idig_search_records()</a></code>
function - API parameter: <code>scientificname</code></p></li>
<li><p>inat - internal function - API parameter: <code>q</code></p></li>
<li><p>obis - internal function - API parameter: <code>scientificName</code></p></li>
<li><p>ala - internal function - API parameter: <code>q</code></p></li>
</ul><p>If you have questions about how each of those parameters behaves with respect to
the terms you pass to it, lookup documentation for those functions, or get in touch
at the development repository <a href="https://github.com/ropensci/spocc/issues" class="external-link">https://github.com/ropensci/spocc/issues</a></p>
    </div>
    <div class="section level2">
    <h2 id="idigbio-notes">iDigBio notes<a class="anchor" aria-label="anchor" href="#idigbio-notes"></a></h2>
    

<p>When searching iDigBio note that by deafult we set <code>fields = "all"</code>, so that we return
a richer suite of fields than the <code>ridigbio</code> R client gives by default. But you can
changes this by passing in a <code>fields</code> parameter to <code>idigbioopts</code> parameter with
the specific fields you want.</p>
<p>Maximum of 100,000 results are allowed to be returned. See
<a href="https://github.com/iDigBio/ridigbio/issues/33" class="external-link">https://github.com/iDigBio/ridigbio/issues/33</a></p>
    </div>
    <div class="section level2">
    <h2 id="inaturalist-notes">iNaturalist notes<a class="anchor" aria-label="anchor" href="#inaturalist-notes"></a></h2>
    

<p>We're using the iNaturalist API, docs at
https://api.inaturalist.org/v1/docs/#!/Observations/get_observations</p>
<p>API rate limits: max of 100 requests per minute, though they ask that you try to keep it
to 60 requests per minute or lower. If they notice usage that has serious impact on their
performance they may institute blocks without notification.</p>
<p>There is a hard limit 0f 10,000 observations with the iNaturalist API. We do paging
internally so you may not see this aspect, but for example, if you request 12,000
records, you won't be able to get that many. The API will error at anything more than
10,000. We now error if you request more than 10,000 from iNaturalist. There are
some alternatives:</p><ul><li><p>Consider exporting data while logged in
to your iNaturalist account, or the iNaturalist research grade observations within
GBIF - see https://www.gbif.org/dataset/50c9509d-22c7-4a22-a47d-8c48425ef4a7 - at
time of this writing it has 8.5 million observations.</p></li>
<li><p>Search for iNaturalist data within GBIF. e.g., the following searches for iNaturalist
data within GBIF and allows more than 10,000 records:
``</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="limit-parameter">limit parameter<a class="anchor" aria-label="anchor" href="#limit-parameter"></a></h2>
    

<p>The <code>limit</code> parameter is set to a default of 500. This means that you will get <strong>up to</strong>
500 results back for each data source you ask for data from. If there are no results for a
particular source, you'll get zero back; if there are 8 results for a particular source, you'll
get 8 back. If there are 501 results for a particular source, you'll get 500 back. You can always
ask for more or less back by setting the limit parameter to any number. If you want to request
a different number for each source, pass the appropriate parameter to each data source via the
respective options parameter for each data source.</p>
    </div>
    <div class="section level2">
    <h2 id="wkt">WKT<a class="anchor" aria-label="anchor" href="#wkt"></a></h2>
    

<p>WKT objects are strings of pairs of lat/long coordinates that define a shape. Many classes
of shapes are supported, including POLYGON, POINT, and MULTIPOLYGON. Within each defined shape
define all vertices of the shape with a coordinate like 30.1 10.1, the first of which is the
latitude, the second the longitude.</p>
<p>Examples of valid WKT objects:</p><ul><li><p>'POLYGON((30.1 10.1, 10 20, 20 60, 60 60, 30.1 10.1))'</p></li>
<li><p>'POINT((30.1 10.1))'</p></li>
<li><p>'LINESTRING(3 4,10 50,20 25)'</p></li>
<li><p>'MULTIPOINT((3.5 5.6),(4.8 10.5))")'</p></li>
<li><p>'MULTILINESTRING((3 4,10 50,20 25),(-5 -8,-10 -8,-15 -4))'</p></li>
<li><p>'MULTIPOLYGON(((1 1,5 1,5 5,1 5,1 1),(2 2,2 3,3 3,3 2,2 2)),((6 3,9 2,9 4,6 3)))'</p></li>
<li><p>'GEOMETRYCOLLECTION(POINT(4 6),LINESTRING(4 6,7 10))'</p></li>
</ul><p>Only POLYGON objects are currently supported.</p>
<p>Getting WKT polygons or bounding boxes. We will soon introduce a function to help you select
a bounding box but for now, you can use a few sites on the web.</p><ul><li><p>Bounding box - <a href="https://boundingbox.klokantech.com/" class="external-link">https://boundingbox.klokantech.com/</a></p></li>
<li><p>Well known text - <a href="http://arthur-e.github.io/Wicket/sandbox-gmaps3.html" class="external-link">http://arthur-e.github.io/Wicket/sandbox-gmaps3.html</a></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="geometry-parameter">geometry parameter<a class="anchor" aria-label="anchor" href="#geometry-parameter"></a></h2>
    

<p>The behavior of the <code>occ</code> function with respect to the <code>geometry</code> parameter
varies depending on the inputs to the <code>query</code> parameter. Here are the options:</p><ul><li><p>geometry (single), no query - If a single bounding box/WKT string passed in,
and no query, a single query is made against each data source.</p></li>
<li><p>geometry (many), no query - If many bounding boxes/WKT strings are passed in,
we do a separate query for each bounding box/WKT string against each data source.</p></li>
<li><p>geometry (single), query - If a single bounding box/WKT string passed in,
and a single query, we do a single query against each data source.</p></li>
<li><p>geometry (many), query - If many bounding boxes/WKT strings are passed in,
and a single query, we do a separate query for each bounding box/WKT string with the
same queried name against each data source.</p></li>
<li><p>geometry (single), many query - If a single bounding box/WKT string passed in,
and many names to query, we do a separate query for each name, using the same geometry,
for each data source.</p></li>
<li><p>geometry (many), many query - If many bounding boxes/WKT strings are passed in,
and many names to query, this poses a problem for all data sources, none of which
accept many bounding boxes of WKT strings. So, in this scenario, we loop over each
name and each geometry query, and then re-combine by queried name, so that you get
back a single group of data for each name.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="geometry-options-by-data-provider">Geometry options by data provider<a class="anchor" aria-label="anchor" href="#geometry-options-by-data-provider"></a></h2>
    

<p><strong>wkt &amp; bbox allowed, see WKT section above</strong></p><ul><li><p>gbif</p></li>
<li><p>obis</p></li>
<li><p>ala</p></li>
</ul><p><strong>bbox only</strong></p><ul><li><p>inat</p></li>
<li><p>idigbio</p></li>
</ul><p><strong>No spatial search allowed</strong></p><ul><li><p>ebird</p></li>
<li><p>vertnet</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="notes-on-the-date-parameter">Notes on the date parameter<a class="anchor" aria-label="anchor" href="#notes-on-the-date-parameter"></a></h2>
    

<p>Date searches with the <code>date</code> parameter are allowed for all sources
except ebird.</p>
<p>Notes on some special cases</p><ul><li><p>idigbio: We search on the <code>datecollected</code> field. Other date fields can be
searched on, but we chose <code>datecollected</code> as it seemed most appropriate.</p></li>
<li><p>vertnet: If you want more flexible date searches, you can pass various
types of date searches to <code>vertnetopts</code>. See <code><a href="https://docs.ropensci.org/rvertnet/reference/searchbyterm.html" class="external-link">rvertnet::searchbyterm()</a></code>
for more information</p></li>
<li><p>ala: There's some issues with the dates returned from ALA. They are
returned as time stamps, and some seem to be malformed. So do beware
of using ALA dates for important things.</p></li>
</ul><p>Get in touch if you have other date search use cases you think
are widely useful</p>
    </div>
    <div class="section level2">
    <h2 id="paging">Paging<a class="anchor" aria-label="anchor" href="#paging"></a></h2>
    

<p>All data sources respond to the <code>limit</code> parameter passed to <code>occ</code>.</p>
<p>Data sources, however, vary as to whether they respond to an offset. Here's
the details on which data sources will respond to <code>start</code> and which
to the <code>page</code> parameter:</p><ul><li><p>gbif - Responds to <code>start</code>. Default: 0</p></li>
<li><p>inat - Responds to <code>page</code>. Default: 1</p></li>
<li><p>ebird - No paging, both <code>start</code> and <code>page</code> ignored.</p></li>
<li><p>vertnet - No paging implemented here, both <code>start</code> and <code>page</code>
ignored. VertNet does have a form of paging, but it uses a cursor, and can't
easily be included  here via parameters. However, <code>rvertnet</code> does paging
internally for you.  For example, the max records per request for VertNet is
1000; if you request 2000 records, we'll do the first request, and do the
second request for you automatically.</p></li>
<li><p>idigbio - Responds to <code>start</code>. Default: 0</p></li>
<li><p>obis - Does not respond to <code>start</code>. They only allow a starting occurrence
UUID up to which to skip. So order of results matters a great deal of course.
To paginate with OBIS, do e.g.
<code>obisopts = list(after = "017b7818-5b2c-4c88-9d76-f4471afe5584")</code>; <code>after</code> can
be combined with the <code>limit</code> value you pass in to the main <code>occ()</code> function
call. See <a href="obis_search.html">obis_search</a> for what parameters can be used.</p></li>
<li><p>ala - Responds to <code>start</code>. Default: 0</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="photographs">Photographs<a class="anchor" aria-label="anchor" href="#photographs"></a></h2>
    

<p>The iNaturalist data source provides photographs of the records returned,
if available. For example, the following will give photos from inat:
<code>occ(query = 'Danaus plexippus', from = 'inat')$inat$data$Danaus_plexippus$photos</code></p>
    </div>
    <div class="section level2">
    <h2 id="beware">BEWARE<a class="anchor" aria-label="anchor" href="#beware"></a></h2>
    

<p>In cases where you request data from multiple providers, especially when
including GBIF, there could be duplicate records since many providers' data eventually
ends up with GBIF. See <code><a href="spocc_duplicates.html">spocc_duplicates()</a></code> for more.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other queries: 
<code><a href="occ_names.html">occ_names</a>()</code>,
<code><a href="occ_names_options.html">occ_names_options</a>()</code>,
<code><a href="occ_options.html">occ_options</a>()</code>,
<code><a href="spocc_objects.html">spocc_objects</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># Single data sources</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">occ</span><span class="op">(</span>query <span class="op">=</span> <span class="st">'Accipiter striatus'</span>, from <span class="op">=</span> <span class="st">'gbif'</span>, limit <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span><span class="op">$</span><span class="va">gbif</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">occ</span><span class="op">(</span>query <span class="op">=</span> <span class="st">'Accipiter striatus'</span>, from <span class="op">=</span> <span class="st">'ebird'</span>, limit <span class="op">=</span> <span class="fl">50</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span><span class="op">$</span><span class="va">ebird</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">occ</span><span class="op">(</span>query <span class="op">=</span> <span class="st">'Danaus plexippus'</span>, from <span class="op">=</span> <span class="st">'inat'</span>, limit <span class="op">=</span> <span class="fl">50</span>,</span></span>
<span class="r-in"><span>  has_coords <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span><span class="op">$</span><span class="va">inat</span></span></span>
<span class="r-in"><span><span class="va">res</span><span class="op">$</span><span class="va">inat</span><span class="op">$</span><span class="va">data</span></span></span>
<span class="r-in"><span><span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/rbindlist.html" class="external-link">rbindlist</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">inat</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">Danaus_plexippus</span><span class="op">$</span><span class="va">photos</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">occ</span><span class="op">(</span>query <span class="op">=</span> <span class="st">'Bison bison'</span>, from <span class="op">=</span> <span class="st">'vertnet'</span>, limit <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span><span class="op">$</span><span class="va">vertnet</span></span></span>
<span class="r-in"><span><span class="va">res</span><span class="op">$</span><span class="va">vertnet</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">Bison_bison</span></span></span>
<span class="r-in"><span><span class="fu"><a href="occ2df.html">occ2df</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Paging</span></span></span>
<span class="r-in"><span><span class="va">one</span> <span class="op">&lt;-</span> <span class="fu">occ</span><span class="op">(</span>query <span class="op">=</span> <span class="st">'Accipiter striatus'</span>, from <span class="op">=</span> <span class="st">'gbif'</span>, limit <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">two</span> <span class="op">&lt;-</span> <span class="fu">occ</span><span class="op">(</span>query <span class="op">=</span> <span class="st">'Accipiter striatus'</span>, from <span class="op">=</span> <span class="st">'gbif'</span>, limit <span class="op">=</span> <span class="fl">5</span>, start <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">one</span><span class="op">$</span><span class="va">gbif</span></span></span>
<span class="r-in"><span><span class="va">two</span><span class="op">$</span><span class="va">gbif</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># iNaturalist limits: they allow at most 10,000; query through GBIF to get</span></span></span>
<span class="r-in"><span><span class="co"># more than 10,000</span></span></span>
<span class="r-in"><span><span class="co"># See https://www.gbif.org/dataset/50c9509d-22c7-4a22-a47d-8c48425ef4a7</span></span></span>
<span class="r-in"><span><span class="co"># x &lt;- occ(query = 'Danaus plexippus', from = 'gbif', limit = 10100, </span></span></span>
<span class="r-in"><span><span class="co">#   gbifopts = list(datasetKey = "50c9509d-22c7-4a22-a47d-8c48425ef4a7"))</span></span></span>
<span class="r-in"><span><span class="co"># x$gbif</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Date range searches across data sources</span></span></span>
<span class="r-in"><span><span class="co">## Not possible for ebird</span></span></span>
<span class="r-in"><span><span class="co">## ala</span></span></span>
<span class="r-in"><span><span class="fu">occ</span><span class="op">(</span>date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'2018-01-01T00:00:00Z'</span>, <span class="st">'2018-03-28T00:00:00Z'</span><span class="op">)</span>, from <span class="op">=</span> <span class="st">'ala'</span>, limit <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## gbif</span></span></span>
<span class="r-in"><span><span class="fu">occ</span><span class="op">(</span>query <span class="op">=</span> <span class="st">'Accipiter striatus'</span>, date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'2010-08-01'</span>, <span class="st">'2010-08-31'</span><span class="op">)</span>, from <span class="op">=</span> <span class="st">'gbif'</span>, limit<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## vertnet</span></span></span>
<span class="r-in"><span><span class="fu">occ</span><span class="op">(</span>query <span class="op">=</span> <span class="st">'Mustela nigripes'</span>, date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'1990-01-01'</span>, <span class="st">'2015-12-31'</span><span class="op">)</span>, from <span class="op">=</span> <span class="st">'vertnet'</span>, limit<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## idigbio</span></span></span>
<span class="r-in"><span><span class="fu">occ</span><span class="op">(</span>query <span class="op">=</span> <span class="st">'Acer'</span>, date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'2010-01-01'</span>, <span class="st">'2015-12-31'</span><span class="op">)</span>, from <span class="op">=</span> <span class="st">'idigbio'</span>, limit<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## obis</span></span></span>
<span class="r-in"><span><span class="fu">occ</span><span class="op">(</span>query <span class="op">=</span> <span class="st">'Mola mola'</span>, date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'2015-01-01'</span>, <span class="st">'2015-12-31'</span><span class="op">)</span>, from <span class="op">=</span> <span class="st">'obis'</span>, limit<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## inat</span></span></span>
<span class="r-in"><span><span class="fu">occ</span><span class="op">(</span>query <span class="op">=</span> <span class="st">'Danaus plexippus'</span>, date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'2015-01-01'</span>, <span class="st">'2015-12-31'</span><span class="op">)</span>, from <span class="op">=</span> <span class="st">'inat'</span>, limit<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Restrict to records with coordinates</span></span></span>
<span class="r-in"><span><span class="fu">occ</span><span class="op">(</span>query <span class="op">=</span> <span class="st">"Acer"</span>, from <span class="op">=</span> <span class="st">"idigbio"</span>, limit <span class="op">=</span> <span class="fl">5</span>, has_coords <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">occ</span><span class="op">(</span>query <span class="op">=</span> <span class="st">'Setophaga caerulescens'</span>, from <span class="op">=</span> <span class="st">'ebird'</span>, ebirdopts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>loc<span class="op">=</span><span class="st">'US'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">occ</span><span class="op">(</span>query <span class="op">=</span> <span class="st">'Spinus tristis'</span>, from <span class="op">=</span> <span class="st">'ebird'</span>, ebirdopts <span class="op">=</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">'ebirdgeo'</span>, lat <span class="op">=</span> <span class="fl">42</span>, lng <span class="op">=</span> <span class="op">-</span><span class="fl">76</span>, dist <span class="op">=</span> <span class="fl">50</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># idigbio data</span></span></span>
<span class="r-in"><span><span class="co">## scientific name search</span></span></span>
<span class="r-in"><span><span class="fu">occ</span><span class="op">(</span>query <span class="op">=</span> <span class="st">"Acer"</span>, from <span class="op">=</span> <span class="st">"idigbio"</span>, limit <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">occ</span><span class="op">(</span>query <span class="op">=</span> <span class="st">"Acer"</span>, from <span class="op">=</span> <span class="st">"idigbio"</span>, idigbioopts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>offset <span class="op">=</span> <span class="fl">5</span>, limit  <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## geo search</span></span></span>
<span class="r-in"><span><span class="va">bounds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">120</span>, <span class="fl">40</span>, <span class="op">-</span><span class="fl">100</span>, <span class="fl">45</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">occ</span><span class="op">(</span>from <span class="op">=</span> <span class="st">"idigbio"</span>, geometry <span class="op">=</span> <span class="va">bounds</span>, limit <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## just class arachnida, spiders</span></span></span>
<span class="r-in"><span><span class="fu">occ</span><span class="op">(</span>idigbioopts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>class <span class="op">=</span> <span class="st">'arachnida'</span><span class="op">)</span><span class="op">)</span>, from <span class="op">=</span> <span class="st">"idigbio"</span>, limit <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## search certain recordsets</span></span></span>
<span class="r-in"><span><span class="va">sets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1ffce054-8e3e-4209-9ff4-c26fa6c24c2f"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"8dc14464-57b3-423e-8cb0-950ab8f36b6f"</span>, </span></span>
<span class="r-in"><span>    <span class="st">"26f7cbde-fbcb-4500-80a9-a99daa0ead9d"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">occ</span><span class="op">(</span>idigbioopts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>recordset <span class="op">=</span> <span class="va">sets</span><span class="op">)</span><span class="op">)</span>, from <span class="op">=</span> <span class="st">"idigbio"</span>, limit <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Many data sources</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">occ</span><span class="op">(</span>query <span class="op">=</span> <span class="st">'Pinus contorta'</span>, from<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'gbif'</span>,<span class="st">'vertnet'</span><span class="op">)</span>, limit<span class="op">=</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Select individual elements</span></span></span>
<span class="r-in"><span><span class="va">out</span><span class="op">$</span><span class="va">gbif</span></span></span>
<span class="r-in"><span><span class="va">out</span><span class="op">$</span><span class="va">gbif</span><span class="op">$</span><span class="va">data</span></span></span>
<span class="r-in"><span><span class="va">out</span><span class="op">$</span><span class="va">vertnet</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Coerce to combined data.frame, selects minimal set of</span></span></span>
<span class="r-in"><span><span class="co">## columns (name, lat, long, provider, date, occurrence key)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="occ2df.html">occ2df</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Pass in limit parameter to all sources. This limits the number of occurrences</span></span></span>
<span class="r-in"><span><span class="co"># returned to 10, in this example, for all sources, in this case gbif and inat.</span></span></span>
<span class="r-in"><span><span class="fu">occ</span><span class="op">(</span>query<span class="op">=</span><span class="st">'Pinus contorta'</span>, from<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'gbif'</span>,<span class="st">'inat'</span><span class="op">)</span>, limit<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Geometry</span></span></span>
<span class="r-in"><span><span class="co">## Pass in geometry parameter to all sources. This constraints the search to the</span></span></span>
<span class="r-in"><span><span class="co">## specified polygon for all sources, gbif in this example.</span></span></span>
<span class="r-in"><span><span class="co">## Check out http://arthur-e.github.io/Wicket/sandbox-gmaps3.html to get a WKT string</span></span></span>
<span class="r-in"><span><span class="fu">occ</span><span class="op">(</span>query<span class="op">=</span><span class="st">'Accipiter'</span>, from<span class="op">=</span><span class="st">'gbif'</span>,</span></span>
<span class="r-in"><span>   geometry<span class="op">=</span><span class="st">'POLYGON((30.1 10.1, 10 20, 20 60, 60 60, 30.1 10.1))'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Or pass in a bounding box, which is automatically converted to WKT (required by GBIF)</span></span></span>
<span class="r-in"><span><span class="co">## via the bbox2wkt function. The format of a bounding box is</span></span></span>
<span class="r-in"><span><span class="co">## [min-longitude, min-latitude, max-longitude, max-latitude].</span></span></span>
<span class="r-in"><span><span class="fu">occ</span><span class="op">(</span>query<span class="op">=</span><span class="st">'Accipiter striatus'</span>, from<span class="op">=</span><span class="st">'gbif'</span>, geometry<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">125.0</span>,<span class="fl">38.4</span>,<span class="op">-</span><span class="fl">121.8</span>,<span class="fl">40.9</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## lots of results, can see how many by indexing to meta</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">occ</span><span class="op">(</span>query<span class="op">=</span><span class="st">'Accipiter striatus'</span>, from<span class="op">=</span><span class="st">'gbif'</span>,</span></span>
<span class="r-in"><span>   geometry<span class="op">=</span><span class="st">'POLYGON((-69.9 49.2,-69.9 29.0,-123.3 29.0,-123.3 49.2,-69.9 49.2))'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span><span class="op">$</span><span class="va">gbif</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## You can pass in geometry to each source separately via their opts parameter, at</span></span></span>
<span class="r-in"><span><span class="co">## least those that support it. Note that if you use rinat, you reverse the order, with</span></span></span>
<span class="r-in"><span><span class="co">## latitude first, and longitude second, but here it's the reverse for consistency across</span></span></span>
<span class="r-in"><span><span class="co">## the spocc package</span></span></span>
<span class="r-in"><span><span class="va">bounds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">125.0</span>,<span class="fl">38.4</span>,<span class="op">-</span><span class="fl">121.8</span>,<span class="fl">40.9</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">occ</span><span class="op">(</span>query <span class="op">=</span> <span class="st">'Danaus plexippus'</span>, from<span class="op">=</span><span class="st">"inat"</span>, geometry<span class="op">=</span><span class="va">bounds</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Passing geometry with multiple sources</span></span></span>
<span class="r-in"><span><span class="fu">occ</span><span class="op">(</span>query <span class="op">=</span> <span class="st">'Danaus plexippus'</span>, from<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"inat"</span>,<span class="st">"gbif"</span><span class="op">)</span>, geometry<span class="op">=</span><span class="va">bounds</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Using geometry only for the query</span></span></span>
<span class="r-in"><span><span class="co">### A single bounding box</span></span></span>
<span class="r-in"><span><span class="fu">occ</span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">bounds</span>, from <span class="op">=</span> <span class="st">"gbif"</span>, limit<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">### Many bounding boxes</span></span></span>
<span class="r-in"><span><span class="fu">occ</span><span class="op">(</span>geometry <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">125.0</span>,<span class="fl">38.4</span>,<span class="op">-</span><span class="fl">121.8</span>,<span class="fl">40.9</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">115.0</span>,<span class="fl">22.4</span>,<span class="op">-</span><span class="fl">111.8</span>,<span class="fl">30.9</span><span class="op">)</span><span class="op">)</span>, from <span class="op">=</span> <span class="st">"gbif"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Geometry only with WKT</span></span></span>
<span class="r-in"><span><span class="va">wkt</span> <span class="op">&lt;-</span> <span class="st">'POLYGON((-98.9 44.2,-89.1 36.6,-116.7 37.5,-102.5 39.6,-98.9 44.2))'</span></span></span>
<span class="r-in"><span><span class="fu">occ</span><span class="op">(</span>from <span class="op">=</span> <span class="st">"gbif"</span>, geometry <span class="op">=</span> <span class="va">wkt</span>, limit <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Specify many data sources, another example</span></span></span>
<span class="r-in"><span><span class="va">ebirdopts</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>loc <span class="op">=</span> <span class="st">'US'</span><span class="op">)</span>; <span class="va">gbifopts</span>  <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>country <span class="op">=</span> <span class="st">'US'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">occ</span><span class="op">(</span>query <span class="op">=</span> <span class="st">'Setophaga caerulescens'</span>, from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'gbif'</span>,<span class="st">'inat'</span>,<span class="st">'ebird'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    gbifopts <span class="op">=</span> <span class="va">gbifopts</span>, ebirdopts <span class="op">=</span> <span class="va">ebirdopts</span>, limit<span class="op">=</span><span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="occ2df.html">occ2df</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Pass in many species names, combine just data to a single data.frame, and</span></span></span>
<span class="r-in"><span><span class="co"># first six rows</span></span></span>
<span class="r-in"><span><span class="va">spnames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Accipiter striatus'</span>, <span class="st">'Setophaga caerulescens'</span>, <span class="st">'Spinus tristis'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">occ</span><span class="op">(</span>query <span class="op">=</span> <span class="va">spnames</span>, from <span class="op">=</span> <span class="st">'gbif'</span>, gbifopts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>hasCoordinate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, limit<span class="op">=</span><span class="fl">25</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="occ2df.html">occ2df</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># no query, geometry, or ids passed</span></span></span>
<span class="r-in"><span><span class="co">## many dataset keys to gbif</span></span></span>
<span class="r-in"><span><span class="va">dsets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"14f3151a-e95d-493c-a40d-d9938ef62954"</span>, <span class="st">"f934f8e2-32ca-46a7-b2f8-b032a4740454"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">occ</span><span class="op">(</span>limit <span class="op">=</span> <span class="fl">20</span>, from <span class="op">=</span> <span class="st">"gbif"</span>, gbifopts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>datasetKey <span class="op">=</span> <span class="va">dsets</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## class name to idigbio</span></span></span>
<span class="r-in"><span><span class="fu">occ</span><span class="op">(</span>limit <span class="op">=</span> <span class="fl">20</span>, from <span class="op">=</span> <span class="st">"idigbio"</span>, idigbioopts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>class <span class="op">=</span> <span class="st">'arachnida'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># taxize integration</span></span></span>
<span class="r-in"><span><span class="co">## You can pass in taxonomic identifiers</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://docs.ropensci.org/taxize/" class="external-link">"taxize"</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/taxize/reference/get_ids.html" class="external-link">get_ids</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Chironomus riparius"</span>,<span class="st">"Pinus contorta"</span><span class="op">)</span>, db <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'itis'</span>,<span class="st">'gbif'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">occ</span><span class="op">(</span>ids <span class="op">=</span> <span class="va">ids</span>, from<span class="op">=</span><span class="st">'gbif'</span>, limit<span class="op">=</span><span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/taxize/reference/get_ids.html" class="external-link">get_ids</a></span><span class="op">(</span><span class="st">"Chironomus riparius"</span>, db <span class="op">=</span> <span class="st">'gbif'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">occ</span><span class="op">(</span>ids <span class="op">=</span> <span class="va">ids</span>, from<span class="op">=</span><span class="st">'gbif'</span>, limit<span class="op">=</span><span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/taxize/reference/get_gbifid.html" class="external-link">get_gbifid</a></span><span class="op">(</span><span class="st">"Chironomus riparius"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">occ</span><span class="op">(</span>ids <span class="op">=</span> <span class="va">ids</span>, from<span class="op">=</span><span class="st">'gbif'</span>, limit<span class="op">=</span><span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## sf classes</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/edzer/sp/" class="external-link">"sp"</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://r-spatial.github.io/sf/" class="external-link">"sf"</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">one</span> <span class="op">&lt;-</span> <span class="fu">Polygon</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">91</span>,<span class="fl">90</span>,<span class="fl">90</span>,<span class="fl">91</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>,<span class="fl">30</span>,<span class="fl">32</span>,<span class="fl">30</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spone</span> <span class="op">=</span> <span class="fu">Polygons</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">one</span><span class="op">)</span>, <span class="st">"s1"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sppoly</span> <span class="op">=</span> <span class="fu">SpatialPolygons</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">spone</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## single polygon in a sf class</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">st_as_sf</span><span class="op">(</span><span class="va">sppoly</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">occ</span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">x</span>, limit<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out</span><span class="op">$</span><span class="va">gbif</span><span class="op">$</span><span class="va">data</span></span></span>
<span class="r-in"><span><span class="fu">mapr</span><span class="fu">::</span><span class="fu">map_leaflet</span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## single polygon in a sfc class</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">st_as_sf</span><span class="op">(</span><span class="va">sppoly</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">occ</span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">x</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, limit<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out</span><span class="op">$</span><span class="va">gbif</span><span class="op">$</span><span class="va">data</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## single polygon in a sf POLYGON class</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">st_as_sf</span><span class="op">(</span><span class="va">sppoly</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">unclass</a></span><span class="op">(</span><span class="va">x</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">occ</span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">x</span>, limit<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out</span><span class="op">$</span><span class="va">gbif</span><span class="op">$</span><span class="va">data</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## two polygons in an sf class</span></span></span>
<span class="r-in"><span><span class="va">one</span> <span class="op">&lt;-</span> <span class="fu">Polygon</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">121.0</span>,<span class="op">-</span><span class="fl">117.9</span>,<span class="op">-</span><span class="fl">121.0</span>,<span class="op">-</span><span class="fl">121.0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">39.4</span>, <span class="fl">37.1</span>, <span class="fl">35.1</span>, <span class="fl">39.4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">two</span> <span class="op">&lt;-</span> <span class="fu">Polygon</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">123.0</span>,<span class="op">-</span><span class="fl">121.2</span>,<span class="op">-</span><span class="fl">122.3</span>,<span class="op">-</span><span class="fl">124.5</span>,<span class="op">-</span><span class="fl">123.5</span>,<span class="op">-</span><span class="fl">124.1</span>,<span class="op">-</span><span class="fl">123.0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">44.8</span>,<span class="fl">42.9</span>,<span class="fl">41.9</span>,<span class="fl">42.6</span>,<span class="fl">43.3</span>,<span class="fl">44.3</span>,<span class="fl">44.8</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spone</span> <span class="op">=</span> <span class="fu">Polygons</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">one</span><span class="op">)</span>, <span class="st">"s1"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sptwo</span> <span class="op">=</span> <span class="fu">Polygons</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">two</span><span class="op">)</span>, <span class="st">"s2"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sppoly</span> <span class="op">=</span> <span class="fu">SpatialPolygons</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">spone</span>, <span class="va">sptwo</span><span class="op">)</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sppoly_df</span> <span class="op">&lt;-</span> <span class="fu">SpatialPolygonsDataFrame</span><span class="op">(</span><span class="va">sppoly</span>, </span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, b<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>,<span class="st">"b"</span><span class="op">)</span>, c<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>,<span class="cn">FALSE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   row.names<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">sppoly</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">st_as_sf</span><span class="op">(</span><span class="va">sppoly_df</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">occ</span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">x</span>, limit<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out</span><span class="op">$</span><span class="va">gbif</span><span class="op">$</span><span class="va">data</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># curl debugging</span></span></span>
<span class="r-in"><span><span class="fu">occ</span><span class="op">(</span>query <span class="op">=</span> <span class="st">'Accipiter striatus'</span>, from <span class="op">=</span> <span class="st">'gbif'</span>, limit<span class="op">=</span><span class="fl">10</span>, </span></span>
<span class="r-in"><span> callopts<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">occ</span><span class="op">(</span>query <span class="op">=</span> <span class="st">'Accipiter striatus'</span>, from <span class="op">=</span> <span class="st">'inat'</span>, </span></span>
<span class="r-in"><span> callopts<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">occ</span><span class="op">(</span>query <span class="op">=</span> <span class="st">'Mola mola'</span>, from <span class="op">=</span> <span class="st">'obis'</span>, limit <span class="op">=</span> <span class="fl">200</span>, </span></span>
<span class="r-in"><span> callopts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">########## More thorough data source specific examples</span></span></span>
<span class="r-in"><span><span class="co"># idigbio</span></span></span>
<span class="r-in"><span><span class="co">## scientific name search</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">occ</span><span class="op">(</span>query <span class="op">=</span> <span class="st">"Acer"</span>, from <span class="op">=</span> <span class="st">"idigbio"</span>, limit <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span><span class="op">$</span><span class="va">idigbio</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## geo search</span></span></span>
<span class="r-in"><span><span class="co">### bounding box</span></span></span>
<span class="r-in"><span><span class="va">bounds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">120</span>, <span class="fl">40</span>, <span class="op">-</span><span class="fl">100</span>, <span class="fl">45</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">occ</span><span class="op">(</span>from <span class="op">=</span> <span class="st">"idigbio"</span>, geometry <span class="op">=</span> <span class="va">bounds</span>, limit <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">### wkt</span></span></span>
<span class="r-in"><span><span class="co"># wkt &lt;- 'POLYGON((-69.9 49.2,-69.9 29.0,-123.3 29.0,-123.3 49.2,-69.9 49.2))'</span></span></span>
<span class="r-in"><span><span class="va">wkt</span> <span class="op">&lt;-</span> <span class="st">'POLYGON((-98.9 44.2,-89.1 36.6,-116.7 37.5,-102.5 39.6,-98.9 44.2))'</span></span></span>
<span class="r-in"><span><span class="fu">occ</span><span class="op">(</span>from <span class="op">=</span> <span class="st">"idigbio"</span>, geometry <span class="op">=</span> <span class="va">wkt</span>, limit <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## limit fields returned</span></span></span>
<span class="r-in"><span><span class="fu">occ</span><span class="op">(</span>query <span class="op">=</span> <span class="st">"Acer"</span>, from <span class="op">=</span> <span class="st">"idigbio"</span>, limit <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>   idigbioopts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fields <span class="op">=</span> <span class="st">"scientificname"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## offset and max_items</span></span></span>
<span class="r-in"><span><span class="fu">occ</span><span class="op">(</span>query <span class="op">=</span> <span class="st">"Acer"</span>, from <span class="op">=</span> <span class="st">"idigbio"</span>, limit <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>   idigbioopts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>offset <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## sort</span></span></span>
<span class="r-in"><span><span class="fu">occ</span><span class="op">(</span>query <span class="op">=</span> <span class="st">"Acer"</span>, from <span class="op">=</span> <span class="st">"idigbio"</span>, limit <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>   idigbioopts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">idigbio</span></span></span>
<span class="r-in"><span><span class="fu">occ</span><span class="op">(</span>query <span class="op">=</span> <span class="st">"Acer"</span>, from <span class="op">=</span> <span class="st">"idigbio"</span>, limit <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>   idigbioopts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sort <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">idigbio</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## more complex queries</span></span></span>
<span class="r-in"><span><span class="co">### parameters passed to "rq", get combined with the name queried</span></span></span>
<span class="r-in"><span><span class="fu">occ</span><span class="op">(</span>query <span class="op">=</span> <span class="st">"Acer"</span>, from <span class="op">=</span> <span class="st">"idigbio"</span>, limit <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>   idigbioopts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>basisofrecord<span class="op">=</span><span class="st">"fossilspecimen"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">idigbio</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### NOTE: no support for multipolygons yet</span></span></span>
<span class="r-in"><span><span class="co">## WKT's are more flexible than bounding box's. You can pass in a WKT with multiple</span></span></span>
<span class="r-in"><span><span class="co">## polygons like so (you can use POLYGON or MULTIPOLYGON) when specifying more than one</span></span></span>
<span class="r-in"><span><span class="co">## polygon. Note how each polygon is in it's own set of parentheses.</span></span></span>
<span class="r-in"><span><span class="co"># occ(query='Accipiter striatus', from='gbif',</span></span></span>
<span class="r-in"><span><span class="co">#    geometry='MULTIPOLYGON((30 10, 10 20, 20 60, 60 60, 30 10),</span></span></span>
<span class="r-in"><span><span class="co">#                           (30 10, 10 20, 20 60, 60 60, 30 10))')</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># OBIS examples</span></span></span>
<span class="r-in"><span><span class="co">## basic query</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">occ</span><span class="op">(</span>query <span class="op">=</span> <span class="st">'Mola mola'</span>, from <span class="op">=</span> <span class="st">'obis'</span>, limit <span class="op">=</span> <span class="fl">200</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## get to obis data</span></span></span>
<span class="r-in"><span><span class="va">res</span><span class="op">$</span><span class="va">obis</span></span></span>
<span class="r-in"><span><span class="co">## get obis + gbif data</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">occ</span><span class="op">(</span>query <span class="op">=</span> <span class="st">'Mola mola'</span>, from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'obis'</span>, <span class="st">'gbif'</span><span class="op">)</span>, limit <span class="op">=</span> <span class="fl">200</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span><span class="op">$</span><span class="va">gbif</span></span></span>
<span class="r-in"><span><span class="va">res</span><span class="op">$</span><span class="va">obis</span></span></span>
<span class="r-in"><span><span class="co">## no match found</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">occ</span><span class="op">(</span>query <span class="op">=</span> <span class="st">'Linguimaera thomsonia'</span>, from <span class="op">=</span> <span class="st">'obis'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## geometry query</span></span></span>
<span class="r-in"><span><span class="va">geometry</span> <span class="op">&lt;-</span> <span class="st">"POLYGON((8.98 48.05,15.66 48.05,15.66 45.40,8.98 45.40,8.98 48.05))"</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">occ</span><span class="op">(</span>from <span class="op">=</span> <span class="st">'obis'</span>, geometry <span class="op">=</span> <span class="va">geometry</span>, limit <span class="op">=</span> <span class="fl">50</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span><span class="op">$</span><span class="va">obis</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Pass in spatial classes</span></span></span>
<span class="r-in"><span><span class="co">## sp classes no longer supported</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Paging</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">res1</span> <span class="op">&lt;-</span> <span class="fu">occ</span><span class="op">(</span>query <span class="op">=</span> <span class="st">'Mola mola'</span>, from <span class="op">=</span> <span class="st">'obis'</span>, limit <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">occ_ids</span> <span class="op">&lt;-</span> <span class="va">res1</span><span class="op">$</span><span class="va">obis</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">Mola_mola</span><span class="op">$</span><span class="va">id</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">res2</span> <span class="op">&lt;-</span> <span class="fu">occ</span><span class="op">(</span>query <span class="op">=</span> <span class="st">'Mola mola'</span>, from <span class="op">=</span> <span class="st">'obis'</span>,</span></span>
<span class="r-in"><span>  limit <span class="op">=</span> <span class="fl">10</span>, obisopts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>after <span class="op">=</span> <span class="va">occ_ids</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">occ_ids</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res1</span><span class="op">$</span><span class="va">obis</span></span></span>
<span class="r-in"><span><span class="va">res2</span><span class="op">$</span><span class="va">obis</span></span></span>
<span class="r-in"><span><span class="co">## Pass in any parameters to obisopts as a list</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">occ</span><span class="op">(</span>query <span class="op">=</span> <span class="st">'Mola mola'</span>, from <span class="op">=</span> <span class="st">'obis'</span>, </span></span>
<span class="r-in"><span>   obisopts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>startdepth <span class="op">=</span> <span class="fl">40</span>, enddepth <span class="op">=</span> <span class="fl">50</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">obis</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">Mola_mola</span><span class="op">$</span><span class="va">minimumDepthInMeters</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">obis</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">Mola_mola</span><span class="op">$</span><span class="va">maximumDepthInMeters</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ALA examples</span></span></span>
<span class="r-in"><span><span class="co">## basic query</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">occ</span><span class="op">(</span>query <span class="op">=</span> <span class="st">'Alaba vibex'</span>, from <span class="op">=</span> <span class="st">'ala'</span>, limit <span class="op">=</span> <span class="fl">200</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## get to ala data</span></span></span>
<span class="r-in"><span><span class="va">res</span><span class="op">$</span><span class="va">ala</span></span></span>
<span class="r-in"><span><span class="fu"><a href="occ2df.html">occ2df</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># geometry search</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">occ</span><span class="op">(</span>query <span class="op">=</span> <span class="st">"Macropus"</span>, from <span class="op">=</span> <span class="st">'ala'</span>,</span></span>
<span class="r-in"><span>  geometry <span class="op">=</span> <span class="st">"POLYGON((145 -37,150 -37,150 -30,145 -30,145 -37))"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span><span class="op">$</span><span class="va">ala</span></span></span>
<span class="r-in"><span><span class="fu"><a href="occ2df.html">occ2df</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg"></div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul><h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul></div>
                    <div class="col-md-3 col-sm-4">
                        <ul><h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul></div>
                    <div class="col-md-2 col-sm-4">
                        <ul><h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul></div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer></div>

  

  

  </body></html>

